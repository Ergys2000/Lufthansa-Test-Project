{"ast":null,"code":"var _jsxFileName = \"/home/ergys/Desktop/Projects/Javascript/hs-frontend/src/shared/Login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { AuthContext } from '../App';\nimport { Input, ActionButton, Form, Label } from '../styled/Components';\nimport apiLink from '../API';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = () => {\n  _s();\n\n  const history = useHistory();\n  const authContext = useContext(AuthContext);\n  const [form, setForm] = useState({\n    email: \"\",\n    password: \"\"\n  });\n\n  const onSubmit = async event => {\n    event.preventDefault();\n    const body = {\n      credentials: { ...form\n      }\n    };\n    await fetch(`${apiLink}/auth/signin`, {\n      method: 'post',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body)\n    }).then(res => res.json()).then(res => {\n      console.log(res);\n\n      if (res.status === \"OK\") {\n        /* Update the authContext */\n        authContext.signIn(res.result.userID, res.result.token);\n        /* Go to the user page */\n\n        history.push(`/u/${res.result.userID}`);\n        /* Set a timeout for when to log the user out of 1 hour */\n\n        setTimeout(() => {\n          alert(\"Your session has expired, please re-login!\");\n          authContext.signOut();\n        }, 60 * 60 * 1000);\n      } else {\n        alert(res.message);\n      }\n    }).catch(err => console.log(err));\n  };\n\n  const onChange = event => {\n    event.preventDefault();\n    const {\n      name,\n      value\n    } = event.target;\n    setForm({ ...form,\n      [name]: value\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-gray-900 m-auto w-9/12 rounded-lg px-10 pt-10 text-center min-w-max max-w-4xl shadow-lg text-gray-300\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-2xl\",\n      children: /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"High School Management System\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 28\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Form, {\n      children: [/*#__PURE__*/_jsxDEV(Label, {\n        children: [\"Email:\", /*#__PURE__*/_jsxDEV(Input, {\n          name: \"email\",\n          value: form.email,\n          onChange: onChange,\n          type: \"text\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(Label, {\n        children: [\"Password:\", /*#__PURE__*/_jsxDEV(Input, {\n          name: \"password\",\n          value: form.password,\n          onChange: onChange,\n          type: \"password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(ActionButton, {\n        onClick: onSubmit,\n        children: \"Log in\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Login, \"W1Nx0NSVOlWbS1WdD0VQY1Vgs+c=\", false, function () {\n  return [useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/home/ergys/Desktop/Projects/Javascript/hs-frontend/src/shared/Login.tsx"],"names":["React","useContext","useState","useHistory","AuthContext","Input","ActionButton","Form","Label","apiLink","Login","history","authContext","form","setForm","email","password","onSubmit","event","preventDefault","body","credentials","fetch","method","headers","JSON","stringify","then","res","json","console","log","status","signIn","result","userID","token","push","setTimeout","alert","signOut","message","catch","err","onChange","name","value","target"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\nimport {\n\tuseHistory,\n} from 'react-router-dom';\nimport { AuthContext } from '../App';\nimport { Input, ActionButton, Form, Label } from '../styled/Components';\nimport apiLink from '../API';\n\nconst Login = () => {\n\tconst history = useHistory();\n\tconst authContext = useContext(AuthContext);\n\n\tconst [form, setForm] = useState({\n\t\temail: \"\",\n\t\tpassword: \"\"\n\t});\n\n\tconst onSubmit = async (event: React.FormEvent) => {\n\t\tevent.preventDefault();\n\t\tconst body = {\n\t\t\tcredentials: {\n\t\t\t\t...form\n\t\t\t}\n\t\t}\n\t\tawait fetch(`${apiLink}/auth/signin`, {\n\t\t\tmethod: 'post',\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\"\n\t\t\t},\n\t\t\tbody: JSON.stringify(body)\n\t\t}).then(res => res.json())\n\t\t\t.then(res => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tif (res.status === \"OK\") {\n\t\t\t\t\t/* Update the authContext */\n\t\t\t\t\tauthContext.signIn(res.result.userID, res.result.token);\n\n\t\t\t\t\t/* Go to the user page */\n\t\t\t\t\thistory.push(`/u/${res.result.userID}`);\n\n\t\t\t\t\t/* Set a timeout for when to log the user out of 1 hour */\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\talert(\"Your session has expired, please re-login!\");\n\t\t\t\t\t\tauthContext.signOut();\n\t\t\t\t\t}, 60*60*1000);\n\t\t\t\t} else {\n\t\t\t\t\talert(res.message);\n\t\t\t\t}\n\t\t\t}).catch(err => console.log(err));\n\t}\n\n\tconst onChange = (event: React.ChangeEvent) => {\n\t\tevent.preventDefault();\n\t\tconst { name, value } = event.target as any;\n\t\tsetForm({ ...form, [name]: value });\n\t}\n\n\treturn (\n\t\t<div className=\"bg-gray-900 m-auto w-9/12 rounded-lg px-10 pt-10 text-center min-w-max max-w-4xl shadow-lg text-gray-300\">\n\t\t\t<p className=\"text-2xl\"><b>High School Management System</b></p>\n\t\t\t<Form>\n\t\t\t\t<Label>\n\t\t\t\t\tEmail:\n\t\t\t\t\t<Input\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tvalue={form.email}\n\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\ttype=\"text\" />\n\t\t\t\t</Label>\n\t\t\t\t<Label>\n\t\t\t\t\tPassword:\n\t\t\t\t\t<Input\n\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\tvalue={form.password}\n\t\t\t\t\t\tonChange={onChange}\n\t\t\t\t\t\ttype=\"password\" />\n\t\t\t\t</Label>\n\t\t\t\t<ActionButton\n\t\t\t\t\tonClick={onSubmit}>\n\t\t\t\t\tLog in\n\t\t\t\t</ActionButton>\n\t\t\t</Form>\n\t\t</div>\n\t);\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}